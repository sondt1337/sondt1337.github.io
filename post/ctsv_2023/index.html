<!doctype html>
<html
  lang="en-us" 
  
    data-theme-mode="true"
  
>
  <head>
    
    <meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no"
/>







  

<title>
  CSTV - CAPTURE THE FLAG 2023 | Digital Forensics | Spid3r
</title>
<meta
  name="description"
  content="Trong bài viết này mình sẽ Writeups 3 bài Digital Forensics"
/>



  <script>
  (function(c,l,a,r,i,t,y){
      c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
      t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
      y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
  })(window, document, "clarity", "script", "true");
</script>


  
<script src="https://www.googletagmanager.com/gtag/js?id=true"></script>
<script data-pjax>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
    dataLayer.push(arguments);
  }

  gtag('js', new Date());

  gtag('config', 'true');
</script>








<script>
  window.siteConfig = JSON.parse("{\"anchor_icon\":null,\"clipboard\":{\"copyright\":{\"content\":\"本文版权：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！\",\"count\":50,\"enable\":false},\"fail\":\"error (ﾟ⊿ﾟ)ﾂ\",\"success\":\"copied(*^▽^*)\"},\"code_block\":{\"expand\":true},\"icon_font\":\"4552607_0khxww3tj3q9\",\"outdate\":{\"daysago\":180,\"enable\":false,\"message\":\"本文最后更新于 {time}，请注意文中内容可能已经发生变化。\"}}");
</script>

<script>
  window.siteConfig.swPath = '\/sw.js';
</script>











  
  
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  


<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  rel="preload"
  as="style"
  href="https://fonts.googleapis.com/css?family=JetBrains%20Mono:400,400italic,700,700italic%7cMulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7cJetBrains%20Mono:400,400italic,700,700italic&amp;display=swap"
/>
<link
  rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=JetBrains%20Mono:400,400italic,700,700italic%7cMulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7cJetBrains%20Mono:400,400italic,700,700italic&amp;display=swap"
  media="print"
  onload="this.media='all'"
/>






  <link
    rel="preload"
    href="//at.alicdn.com/t/c/font_4552607_0khxww3tj3q9.woff2"
    as="font"
    type="font/woff2"
    crossorigin="anonymous"
  />





  <meta property="og:type" content="website" />
  <meta property="og:title" content="CSTV - CAPTURE THE FLAG 2023 | Digital Forensics | Spid3r" />
  <meta
    property="og:description"
    content="Trong bài viết này mình sẽ Writeups 3 bài Digital Forensics"
  />
  <meta property="og:url" content="https://blog.sondt.id.vn/post/ctsv_2023/" />
  <meta
    property="og:site_name"
    content="Adventures of Spid3r"
  />
  <meta
    property="og:image"
    content="/images/ctsv_2023/featured.png"
  />
  <meta property="article:author" content="Spid3r" />
  <meta property="article:published_time" content="2024-01-06T11:00:00-07:00" />
  <meta property="article:modified_time" content="2024-01-06T11:00:00-07:00" />
  
    <meta property="article:tag" content="Digital ForensicsWriteups" />
  
  
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:image" content="/images/ctsv_2023/featured.png" />
  
  
  
  
  




<link rel="shortcut icon" href="/favicon.ico">








  
 <link rel="stylesheet" href="/css/main.min.a6d178773947d1c76596c54c2443acf75cd46e3b9a6f1c7c7f04a9498cb763bf.css" />





  <link
    rel="preload"
    as="style"
    href="https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css"
    onload="this.onload=null;this.rel='stylesheet'"
  />






  <link
    rel="preload"
    as="style"
    href="https://npm.webcache.cn/katex@0.16.9/dist/katex.min.css"
    onload="this.onload=null;this.rel='stylesheet'"
  />








  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js"
    
    
    
    
    integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous"
  ></script>





  


  <link rel="stylesheet" href="https://npm.webcache.cn/@reimujs/aos@0.1.0/dist/aos.css" />








  <link rel="stylesheet" href="https://npm.webcache.cn/aplayer@1.10.1/dist/APlayer.min.css" />



    
  </head>
  <body>
    
    

<div id="copy-tooltip" style="pointer-events: none; opacity: 0; transition: all 0.2s ease; position: fixed;top: 50%;left: 50%;z-index: 999;transform: translate(-50%, -50%);color: white;background: rgba(0, 0, 0, 0.5);padding: 10px 15px;border-radius: 10px;">
</div>


  <div class="notification-wrapper">
    <h1>New version found</h1>
    <p>The website seems to have new content, do you want to update?</p>
    <div class="notification-btn">
      <button id="notification-update-btn">Update</button>
      <button id="notification-close-btn">Cancel</button>
    </div>
  </div>

    <div id="container">
      <div id="wrap">
        
<div id="header-nav">
  <nav id="main-nav">
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon '>
          
            &#xe632;
          
        </div>
        <a class="main-nav-link" href="/">Home</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon '>
          
            &#xe604;
          
        </div>
        <a class="main-nav-link" href="/archives">Archives</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon '>
          
            &#xe628;
          
        </div>
        <a class="main-nav-link" href="/about">About</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon '>
          
            &#xe621;
          
        </div>
        <a class="main-nav-link" href="/achievements">Achievements</a>
      </span>
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
    
      <a id="nav-search-btn" class="nav-icon popup-trigger" title="Search"></a>
    
  </nav>
</div>
<header id="header">
  
    <picture></picture>
    <img fetchpriority="high" src="/images/ctsv_2023/featured.png" alt="CSTV - CAPTURE THE FLAG 2023 | Digital Forensics">
  

  <div id="header-outer">
    <div id="header-title">
      
        
        
          
        
  
        
          <a href="/" id="logo">
            <h1 data-aos="slide-up">CSTV - CAPTURE THE FLAG 2023 | Digital Forensics</h1>
          </a>
        
      
  
      
        
        
        <h2 id="subtitle-wrap" data-aos="slide-down">
          
        </h2>
      
    </div>
  </div>
</header>
        <div id="content"
          
          class="sidebar-right"  >
          <aside id="sidebar">
  
  
    <div id="aplayer" theme="var(--color-link)" data-aos="fade-up"></div>
  
  
  <div class="sidebar-wrapper wrap-sticky">
    <div
      class="sidebar-wrap"
      data-aos="fade-up"
    >
      
        
          <div class="sidebar-toc-sidebar">
            <div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper toc-div-class">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#lost-puppey">Lost Puppey</a></li>
    <li><a href="#whose-name-is-it">Whose name is it?</a></li>
    <li><a href="#l4g">L4g</a></li>
  </ul>
</nav>
  </div>
</div>
          </div>
          <div class="sidebar-common-sidebar hidden">
            
<div class="sidebar-author">
  <img
    data-src="/avatar/../images/avatar.jpg"
    data-sizes="auto"
    alt="Spid3r"
    class="lazyload"
  />
  <div class="sidebar-author-name">Spid3r</div>
  <div class="sidebar-description">I&#39;m a little spider</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    
    <div class="sidebar-state-number">11</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">
      1
    </div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">4</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/"
        aria-label="Home"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe632;
        
      </div>
      <div class="sidebar-menu-link">Home</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/archives"
        aria-label="Archives"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe604;
        
      </div>
      <div class="sidebar-menu-link">Archives</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/about"
        aria-label="About"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe628;
        
      </div>
      <div class="sidebar-menu-link">About</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/achievements"
        aria-label="Achievements"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe621;
        
      </div>
      <div class="sidebar-menu-link">Achievements</div>
    </div>
  
</div>

          </div>
        
      

      
        
          <div class="sidebar-btn-wrapper" style="position:static">
            <div class="sidebar-toc-btn current"></div>
            <div class="sidebar-common-btn"></div>
          </div>
        
      
    </div>
  </div>

  <div class="sidebar-widget">
    
  </div>
  
</aside>

          <section id="main">
  <article
  class="h-entry article"
  itemprop="blogPost"
  itemscope
  itemtype="https://schema.org/BlogPosting"
>
  <div
    class="article-inner"
    data-aos="fade-up"
  >
    <div class="article-meta">
      <div class="article-date">
  <span
    class="article-date-link"
    data-aos="zoom-in"
  >
    <time datetime="2024-01-06 11:00:00 -0700 -0700" itemprop="datePublished"
      >2024-01-06</time
    >
    <time style="display: none;" id="post-update-time"
      >2024-01-06</time
    >
  </span>
</div>

      <div class="article-category">
  
    <a
      class="article-category-link"
      href="/categories/ctf"
      data-aos="zoom-in"
      >CTF</a
    >
  
</div>

    </div>
    <div class="hr-line"></div>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
      
        <p><img src="/images/ctsv_2023/featured.png" alt=""></p>
<p>Nói thật thì đây là 1 giải khá khó chịu với mình, vì ngoài độ guessing của các thử thách (forensics, mobile) thì thật ra chẳng có gì để nói cả (và rất tiếc với 1 mình mình làm thì không thể giải quyết được toàn bộ cùng 1 lúc)</p>
<p>Giải này thì mình đăng ký team nhưng hôm thi thì chỉ có 1 mình try hard :))), lấy được top 3</p>
<p><img src="/images/ctsv_2023/prize.png" alt=""></p>
<h2 id="lost-puppey">
<a class="header-anchor" href="#lost-puppey"></a>
Lost Puppey
</h2><blockquote>
<p>Description: This is my lost puppey. He is trying to hide himself and hide something from me. Can you find them for me?</p></blockquote>
<p>Attachment: <a href="/images/ctsv_2023/attachment/Lost.docx">Lost.docx</a></p>
<p>Đề bài cho mình 1 file docx, dựa vào đề bài để tìm xem thứ gì bị ẩn giấu thì với kinh nghiệm mình sẽ unzip nó ra</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>root㉿kali<span class="o">)</span>-<span class="o">[</span>/home/kali/Desktop/cstv<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─# unzip Lost.docx 
</span></span><span class="line"><span class="cl">Archive:  Lost.docx
</span></span><span class="line"><span class="cl">  inflating: <span class="o">[</span>Content_Types<span class="o">]</span>.xml     
</span></span><span class="line"><span class="cl">  inflating: _rels/.rels             
</span></span><span class="line"><span class="cl">  inflating: word/_rels/document.xml.rels  
</span></span><span class="line"><span class="cl">  inflating: word/document.xml       
</span></span><span class="line"><span class="cl"> extracting: word/media/image1.jpg   
</span></span><span class="line"><span class="cl"> extracting: word/media/image2.jpg   
</span></span><span class="line"><span class="cl">  inflating: word/theme/theme1.xml   
</span></span><span class="line"><span class="cl">  inflating: word/settings.xml       
</span></span><span class="line"><span class="cl">  inflating: docProps/core.xml       
</span></span><span class="line"><span class="cl">  inflating: docProps/app.xml        
</span></span><span class="line"><span class="cl">  inflating: word/webSettings.xml    
</span></span><span class="line"><span class="cl">  inflating: word/styles.xml         
</span></span><span class="line"><span class="cl">  inflating: word/fontTable.xml 
</span></span></code></pre></div><p>Ở đây để ý rằng có 2 file media trong thư mục <code>word/media/</code></p>
<p><img src="/images/ctsv_2023/image.png" alt="word/media/"></p>
<p>Có vẻ như <code>image1.jpg</code> đang bị corrupt, mình sẽ kiểm tra các byte và header xem có vấn đề gì không</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>root㉿kali<span class="o">)</span>-<span class="o">[</span>/home/…/Desktop/cstv/word/media<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─# xxd image1.jpg 
</span></span><span class="line"><span class="cl">00000000: 504b <span class="m">0304</span> <span class="m">1400</span> <span class="m">0900</span> <span class="m">0800</span> d922 <span class="m">0955</span> 4ac4  PK.........<span class="s2">&#34;.UJ.
</span></span></span><span class="line"><span class="cl"><span class="s2">00000010: 894f 8fde 0200 59e1 0200 0800 1c00 7465  .O....Y.......te
</span></span></span><span class="line"><span class="cl"><span class="s2">00000020: 7374 2e6a 7067 5554 0900 035a 19f2 620f  st.jpgUT...Z..b.
</span></span></span><span class="line"><span class="cl"><span class="s2">00000030: 1af2 6275 780b 0001 04e8 0300 0004 e803  ..bux...........
</span></span></span><span class="line"><span class="cl"><span class="s2">00000040: 0000 413d 3e5e 82e4 e725 28b6 3da2 ab50  ..A=&gt;^...%(.=..P
</span></span></span><span class="line"><span class="cl"><span class="s2">00000050: f6e0 2ad2 47c4 a8af 7599 2983 861a 5c2e  ..*.G...u.)...\.
</span></span></span><span class="line"><span class="cl"><span class="s2">00000060: 7ec5 636d 2019 9865 db00 2663 779f afff  ~.cm ..e..&amp;cw...
</span></span></span><span class="line"><span class="cl"><span class="s2">00000070: 18a2 0efe 5ef0 ab03 f443 dd7d 84a4 ba16  ....^....C.}....
</span></span></span><span class="line"><span class="cl"><span class="s2">00000080: d23d b327 64b3 6c03 7be3 d7e3 77b2 7d38  .=.&#39;d.l.{...w.}8
</span></span></span></code></pre></div><p>Yah, vậy nó thực chất là 1 file ZIP, đến đây cần giải nén nó ra nhưng xuất hiện thêm 1 vấn đề mới: password của file ZIP, với độ lỏ này thì chạy tools <a href="https://www.kali.org/tools/john/#zip2john">zip2john</a> chắc là được rồi</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>root㉿kali<span class="o">)</span>-<span class="o">[</span>/home/…/Desktop/cstv/word/media<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─# zip2john image1.zip &gt; hash.txt
</span></span><span class="line"><span class="cl">Created directory: /root/.john
</span></span><span class="line"><span class="cl">ver 2.0 efh <span class="m">5455</span> efh <span class="m">7875</span> image1.zip/test.jpg PKZIP Encr: TS_chk, <span class="nv">cmplen</span><span class="o">=</span>188047, <span class="nv">decmplen</span><span class="o">=</span>188761, <span class="nv">crc</span><span class="o">=</span>4F89C44A <span class="nv">ts</span><span class="o">=</span>22D9 <span class="nv">cs</span><span class="o">=</span>22d9 <span class="nv">type</span><span class="o">=</span><span class="m">8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>root㉿kali<span class="o">)</span>-<span class="o">[</span>/home/…/Desktop/cstv/word/media<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─# john hash.txt                                            
</span></span><span class="line"><span class="cl">Using default input encoding: UTF-8
</span></span><span class="line"><span class="cl">Loaded <span class="m">1</span> password <span class="nb">hash</span> <span class="o">(</span>PKZIP <span class="o">[</span>32/64<span class="o">])</span>
</span></span><span class="line"><span class="cl">Will run <span class="m">4</span> OpenMP threads
</span></span><span class="line"><span class="cl">Proceeding with single, rules:Single
</span></span><span class="line"><span class="cl">Press <span class="s1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class="k">for</span> status
</span></span><span class="line"><span class="cl">Almost <span class="k">done</span>: Processing the remaining buffered candidate passwords, <span class="k">if</span> any.
</span></span><span class="line"><span class="cl">Proceeding with wordlist:/usr/share/john/password.lst
</span></span><span class="line"><span class="cl">loveyou          <span class="o">(</span>image1.zip/test.jpg<span class="o">)</span>     
</span></span><span class="line"><span class="cl">1g 0:00:00:00 DONE 2/3 <span class="o">(</span>2024-01-06 18:19<span class="o">)</span> 33.33g/s 1587Kp/s 1587Kc/s 1587KC/s 123456..ferrises
</span></span><span class="line"><span class="cl">Use the <span class="s2">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span class="line"><span class="cl">Session completed. 
</span></span></code></pre></div><p>Vậy mật khẩu file ZIP này là <code>loveyou</code> sau khi giải nén ra thì được cái ảnh <a href="/images/ctsv_2023/attachment/test.jpg">test.png</a></p>
<p>Với JPG thì mình không nghĩ nhiều cho lắm, ném lên <a href="https://www.aperisolve.com/">Aperi&rsquo;Solve</a> cho tự xử lý nốt</p>
<p><img src="/images/ctsv_2023/image-1.png" alt="Steghide"></p>
<p>flag: <code>hackathon{bbc649da49b02570835df50fd173bff7d4933f07}</code></p>
<h2 id="whose-name-is-it">
<a class="header-anchor" href="#whose-name-is-it"></a>
Whose name is it?
</h2><blockquote>
<p>Description: I fell like there are many people drawing my secret&hellip;</p></blockquote>
<p>Attachment: <a href="/images/ctsv_2023/attachment/capture.pcap">capture.pcap</a></p>
<p><img src="/images/ctsv_2023/image-3.png" alt="capture.pcap"></p>
<p>Ở chall thứ 2 thì có vẻ đúng hơn 1 chút với cái nghĩa forensics &hellip;</p>
<p><img src="/images/ctsv_2023/image-2.png" alt="HTTP object"></p>
<p>Sau khi check các object xuất hiện trong lưu lượng mạng thì thấy có 1 file thực thi (mình đã rev nó + decompile thử) nhưng mà không có gì để &ldquo;khai thác&rdquo; nên chuyển hướng qua phương án khác</p>
<p>Trong quá trình tìm kiếm thì mình có thấy trong udp stream xuất hiện việc gửi nhận 1 txt nào đó khá khả nghi</p>
<p><img src="/images/ctsv_2023/image-4.png" alt=""></p>
<p>Bắt thử 1 query trong đó và decode thử theo thói quen thì thấy rằng đây là header của 1 file ZIP, thấy có hope nên theo hướng này luôn</p>
<p><img src="/images/ctsv_2023/image-5.png" alt=""></p>
<p>Vậy việc của mình bây giờ chỉ là filter toàn bộ các udp.stream từ 188 đến 1569 (kết thúc) để filter với <code>dns &amp;&amp; udp.stream &gt;= 188 &amp;&amp; udp.stream &lt;= 1569</code> và viết script để loại bỏ các phần thừa rồi ném qua cyberchef cho xử lý nốt</p>
<p><img src="/images/ctsv_2023/image-6.png" alt=""></p>
<p>script:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\b(\d+\.\d+[a-fA-F\d]+)\.\w+\.\w+\.\w+\b&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;dnsfilter.txt&#34;</span><span class="p">,</span><span class="s2">&#34;r&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">input_text</span><span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">();</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span><span class="n">input_text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;output.txt&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Các queries trùng lặp 6 lần, loại bỏ bớt  </span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="k">match</span><span class="p">),</span> <span class="mi">6</span><span class="p">):</span> 
</span></span><span class="line"><span class="cl">      <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="k">match</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</span></span></code></pre></div><p><img src="/images/ctsv_2023/image-7.png" alt=""></p>
<p>flag: <code>CSTV_2023_{ba69f4c8c869295a9a8024b32a177bc63a942ffd}</code></p>
<h2 id="l4g">
<a class="header-anchor" href="#l4g"></a>
L4g
</h2><blockquote>
<p>Description: Can you deal with the lagging. If you can f the lag You will get the flag.</p></blockquote>
<p>Attachment: <a href="/images/ctsv_2023/attachment/3y3L4g">3y3L4g</a> &amp; <a href="/images/ctsv_2023/attachment/34rL4g.wav">34rL4g.wav</a></p>
<p>Ở thử thách for cuối cùng này thì mình nhận được 2 file (1 wav và 1 file data), với kinh nghiệm thì mình xiên được file WAV đầu tiên bằng việc xem ảnh phổ của âm thanh</p>
<p><img src="/images/ctsv_2023/image-8.png" alt=""></p>
<p>Nhìn qua thì thấy rằng đây là 1 đoạn mã Morse đơn giản &ndash;&gt; <code>WH4TY0UH34R1SN0TWH4TY0US33KF0R</code>, cái này chắc là để dùng sau vì còn 1 file mắt lag nữa (mình nghi là file ảnh)</p>
<p><img src="/images/ctsv_2023/image-9.png" alt=""></p>
<p>Dựa vào header của file này thì đúng là các byte đã bị sửa và bản gốc là 1 file ảnh PNG, mình sẽ sửa lại header trước thành <code>PNG</code></p>
<p>Ngoài ra thì còn 1 thứ khiến mình để ý nữa là <code>1HdR</code>, khả năng là bị lỗi chunk (<code>IHDR</code>)</p>
<p>Ở đây mình sử dụng tool: <a href="https://github.com/Pourliver/PNG-Fixer">PNG-Fixer</a> để kiểm tra các chunk có vấn đề</p>
<p><img src="/images/ctsv_2023/image-11.png" alt=""></p>
<p><img src="/images/ctsv_2023/image-10.png" alt=""></p>
<p>Vậy là từ đây thì biết được có 2 chunk bị sai là <code>1HdR</code> và <code>IPAD</code> (<code>IHDR</code> và <code>IDAT</code>) tiến hành sửa lại toàn bộ (bằng HexEd)</p>
<p>Sau khi fix xong chunk thì sẽ chuyển qua [PCRT](để kiểm tra các tổng quan các byte)</p>
<p><img src="/images/ctsv_2023/image-12.png" alt=""></p>
<p>Mình vừa mới fix lại cái IPAD xong nên bây giờ cần sửa lại IDAT chunk data length ở offset 0xD0002 (bằng HexEd)</p>
<p><img src="/images/ctsv_2023/image-14.png" alt=""></p>
<p>Cứ vậy sửa lỗi tiếp đến bao giờ có thể nhìn được ảnh (bỏ qua bước sửa CRC chunk vì ảnh ban đầu đã lỗi sẵn)</p>
<p>Ảnh sau khi sửa xong: <a href="/images/ctsv_2023/attachment/ouput.png">output.png</a></p>
<p><img src="/images/ctsv_2023/image-13.png" alt=""></p>
<p>Mở trên Windows sẽ nhìn thấy luôn chứ không bị lỗi nữa, có thể đọc đoạn chữ trên ảnh là: <code>Mắt hơi lag xin thông cảm</code> và đoạn số là <code>123321232123</code></p>
<p>Đến hiện tại thì cả 2 file mình đã khai thác được toàn bộ file ảnh (bao gồm cả metadata của ảnh nữa) vậy chỉ còn lại file wav là chưa thực sự khai thác hết, với đoạn key trên có lẽ là pass của việc dùng tool? bài này stegano nên chắc cũng chỉ được có thế
(mình mất nhiều thời gian suy nghĩ đủ hướng chỉnh ảnh các kiểu &hellip;)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>root㉿kali<span class="o">)</span>-<span class="o">[</span>/home/kali/Downloads<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─# steghide extract -sf 34rL4g.wav 
</span></span><span class="line"><span class="cl">Enter passphrase: 
</span></span><span class="line"><span class="cl">wrote extracted data to <span class="s2">&#34;Br41nL4g.txt&#34;</span>.
</span></span></code></pre></div><p>yah, xong lag mắt, lag tai giờ đến lag não, không biết troll gì nữa đây &hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">+++&gt;-&lt;+-.-+.+-+
</span></span><span class="line"><span class="cl">++++--+---+&lt;.-+
</span></span><span class="line"><span class="cl">+&gt;++--+--.+.--+
</span></span><span class="line"><span class="cl">+++.--+--&lt;+&gt;--+
</span></span><span class="line"><span class="cl">++++--+---+-.-.
</span></span><span class="line"><span class="cl">++++--..-.+--.&lt;
</span></span><span class="line"><span class="cl">++&lt;+--&lt;.-&gt;+--&lt;.
</span></span><span class="line"><span class="cl">++&lt;+.--+-++--..
</span></span><span class="line"><span class="cl">++&lt;++--+.++.-&gt;.
</span></span><span class="line"><span class="cl">++&lt;++--.-+++-+.
</span></span><span class="line"><span class="cl">[&gt;-.+--+-+++-+.
</span></span><span class="line"><span class="cl">&gt;+]-+--+-+++-+.
</span></span><span class="line"><span class="cl">++&gt;-+--+-+++-+.
</span></span><span class="line"><span class="cl">&gt;+&gt;-+..+-+++-+.
</span></span><span class="line"><span class="cl">++&gt;-.&gt;&gt;+-+++-+.
</span></span></code></pre></div><p>Đến đây thì mình khá cạn lời rồi, vì brainfuck này không phải là nạp vào là ra mà phải lag tí não nữa mới được, chắc là cũng đọc theo chiều dọc giống như cái ảnh kia?</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="s2">&#34;+++&gt;-&lt;+-.-+.+-+++++--+---+&lt;.-++&gt;++--+--.+.--++++.--+--&lt;+&gt;--+++++--+---+-.-.++++--..-.+--.&lt;++&lt;+--&lt;.-&gt;+--&lt;.++&lt;+.--+-++--..++&lt;++--+.++.-&gt;.++&lt;++--.-+++-+.[&gt;-.+--+-+++-+.&gt;+]-+--+-+++-+.++&gt;-+--+-+++-+.&gt;+&gt;-+..+-+++-+.++&gt;-.&gt;&gt;+-+++-+.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">15</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">end</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++.++++++.-----------.++++++.&lt;------------.&gt;+++++.&lt;------.&gt;-----..++.+++++.-------.--------.&lt;-.&gt;+++++++++++++++++++++++.&lt;.&gt;----.+++++++.--.---------------.&lt;.&gt;++++++++++.&lt;.........</span>
</span></span></code></pre></div><p><img src="/images/ctsv_2023/image-15.png" alt=""></p>
<p>yah got it, giờ chỉ cần chuyển nó qua sha1 rồi nộp flag thôi :3 (và đến cuối cùng thì cái mã morse trong file wav ban đầu chẳng để làm gì :3)</p>
<p>flag: <code>CSTV_2023_{1d7e89b852c2ef64283df637d0a36f16c3417f18}</code></p>

      
    </div>
    <footer class="article-footer">
      
        






<blockquote class="article-copyright">
  
    <p><strong><span class="icon-user icon"></span>Author: </strong>Spid3r @ Adventures of Spid3r</p>
  
  
  
  
    <p><strong><span class="icon-calendar icon"></span>Published: </strong>2024-01-06 11:00:00</p>
  
  
  
    <p>
      <strong><span class="icon-copyright icon"></span>License: </strong>
      All articles on this blog are licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener external nofollow noreferrer" target="_blank"><span class="icon-creative-commons"></span>BY-NC-SA</a> license agreement unless otherwise stated. Please indicate the source when reprinting!
    </p>
    <span class="icon-creative-commons article-copyright-bg"></span>
  
</blockquote>

      

      
        <div class="sponsor-wrapper">
  <div class="sponsor-button-wrapper">
    <div class="sponsor-icon rotate"></div>
    <div class="sponsor-title">Sponsor</div>
    <div class="sponsor-icon rotate"></div>
  </div>
  <div class="sponsor-tip">Buy the author a coffee!</div>
  
    <div class="sponsor-qr">
      
        <div class="sponsor-qr-image-wrapper">
          <img src="/images/bmc_qr.png" alt="buymeacoffee.com/spid3r" width="200" />
          <p class="sponsor-qr-name">buymeacoffee.com/spid3r</p>
        </div>
      
    </div>
  
</div>
      

      

      

      

      

      

      
      <ul class="article-tag-list" itemprop="keywords">
  
    <li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/digital-forensics"
        rel="tag"
        >DIGITAL FORENSICS</a
      >
    </li>
  
    <li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/writeups"
        rel="tag"
        >WRITEUPS</a
      >
    </li>
  
</ul>

    </footer>
  </div>
  
    
  <nav
    id="article-nav"
    data-aos="fade-up"
  >
    
      <div class="article-nav-link-wrap article-nav-link-left">
        
          <img
            data-src="/images/backdoorctf-2023-re/featured.png"
            data-sizes="auto"
            alt="Backdoor CTF 2023 | Reverse Engineering"
            class="lazyload"
          />
        
        <a href="https://blog.sondt.id.vn/post/backdoor-ctf-2023/"></a>
        <div class="article-nav-caption">Newer</div>
        <h3 class="article-nav-title">
          
            Backdoor CTF 2023 | Reverse Engineering
          
        </h3>
      </div>
    

    
      <div class="article-nav-link-wrap article-nav-link-right">
        
          <img
            data-src="images/isitdtu_ph1sher_quals/featured.png"
            data-sizes="auto"
            alt="Writeups ISITDTU 2024 (Quals) - ph1sher"
            class="lazyload"
          />
        
        <a href="https://blog.sondt.id.vn/post/isitdtu_ph1sher_quals/"></a>
        <div class="article-nav-caption">Older</div>
        <h3 class="article-nav-title">
          
            Writeups ISITDTU 2024 (Quals) - ph1sher
          
        </h3>
      </div>
    
  </nav>


  
</article>










</section>
        </div>
        
        
        



  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  



<footer id="footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info">
    
      <div style="flex-direction:column;align-items: center;"><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"></a>
    
    <div>
      <span class="icon-copyright"></span>
      2021 -
      2025
      <span class="footer-info-sep rotate"></span>
      Spid3r
    </div>
    
      <div>
        <span class="icon-brush"
          >&nbsp;
            19.8k
          </span
        >
        &nbsp;|&nbsp;
        <span class="icon-coffee">&nbsp;
          
          

          01:39
        </span>
      </div>
    
    
    
    
      <div>
        <span class="icon-eye"></span>
        <span id="busuanzi_container_site_pv"
          >Number of visits&nbsp;<span
            id="busuanzi_value_site_pv"
          ></span
        ></span>
        &nbsp;|&nbsp;
        <span class="icon-user"></span>
        <span id="busuanzi_container_site_uv"
          >Number of visitors&nbsp;<span
            id="busuanzi_value_site_uv"
          ></span
        ></span>
      </div>
    
  </div>
</footer>

        
          <div class="sidebar-top">
            <div class="sidebar-top-taichi rotate"></div>
            <div class="arrow-up"></div>
          </div>
        
        <div id="mask" class="hide"></div>
      </div>
      <nav id="mobile-nav">
  <div class="sidebar-wrap">
    
      
        <div class="sidebar-toc-sidebar">
          <div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper toc-div-class">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#lost-puppey">Lost Puppey</a></li>
    <li><a href="#whose-name-is-it">Whose name is it?</a></li>
    <li><a href="#l4g">L4g</a></li>
  </ul>
</nav>
  </div>
</div>
        </div>
        <div class="sidebar-common-sidebar hidden">
          
<div class="sidebar-author">
  <img
    data-src="/avatar/../images/avatar.jpg"
    data-sizes="auto"
    alt="Spid3r"
    class="lazyload"
  />
  <div class="sidebar-author-name">Spid3r</div>
  <div class="sidebar-description">I&#39;m a little spider</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    
    <div class="sidebar-state-number">11</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">
      1
    </div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">4</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/"
        aria-label="Home"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe632;
        
      </div>
      <div class="sidebar-menu-link">Home</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/archives"
        aria-label="Archives"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe604;
        
      </div>
      <div class="sidebar-menu-link">Archives</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/about"
        aria-label="About"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe628;
        
      </div>
      <div class="sidebar-menu-link">About</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/achievements"
        aria-label="Achievements"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe621;
        
      </div>
      <div class="sidebar-menu-link">Achievements</div>
    </div>
  
</div>

        </div>
      
    
  </div>
  
    
      <div class="sidebar-btn-wrapper">
        <div class="sidebar-toc-btn current"></div>
        <div class="sidebar-common-btn"></div>
      </div>
    
  
</nav>

    </div>
    
      <div class="site-search">
        <div class="reimu-popup popup">
          <div class="reimu-search">
            <div class="reimu-search-input-icon"></div>
            <div class="reimu-search-input" id="reimu-search-input"></div>
            <div class="popup-btn-close"></div>
          </div>
          <div class="reimu-results">
            <div id="reimu-stats"></div>
            <div id="reimu-hits"></div>
            <div id="reimu-pagination" class="reimu-pagination"></div>
          </div>
          <img class="reimu-bg" src="/images/reimu.png" />
        </div>
      </div>
    
    






  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js"
    
    
    
    
    integrity="sha384-3gT/vsepWkfz/ff7PpWNUeMzeWoH3cDhm/A8jM7ouoAK0/fP/9bcHHR5kHq2nf&#43;e" crossorigin="anonymous"
  ></script>




  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js"
    
    
    
    
    integrity="sha384-J08i8An/QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q" crossorigin="anonymous"
  ></script>









  
      
      <script src="/js/main.js" integrity="" crossorigin="anonymous" ></script>
      



  





  
      
      <script src="/js/aos.js" integrity="" crossorigin="anonymous" ></script>
      

  <script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", aosInit);
    } else {
      aosInit();
    }
  </script>








  
      
      <script src="/js/pjax_main.js" integrity="" crossorigin="anonymous" data-pjax></script>
      



  <script>
    var ALGOLIA_CONFIG = {
      logo: '\/images\/algolia_logo.svg',
      algolia: {
        applicationID: "",
        apiKey: "",
        indexName: "",
        hits: {
          "per_page": parseInt("10")
        },
        labels: {
          "input_placeholder": "搜索.....",
          "hits_empty": "未发现与 「${query}」相关内容",
          "hits_stats": "找到${hits}条结果（用时 ${time} ms）"
        }
      }
    };
  </script>
  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/algoliasearch@4.17.1/dist/algoliasearch-lite.umd.js"
    defer
    
    
    
    integrity="sha384-xvLS0jfKuoREs7pqkRI/OI8GcqohO5S&#43;jQz7ZBtQXnsXmD&#43;9jDOOY4cL6dCPzlrk" crossorigin="anonymous"
  ></script>


  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/instantsearch.js@4.56.1/dist/instantsearch.production.min.js"
    defer
    
    
    
    integrity="sha384-hHJCflT4KBLQyHfKO9vpstIcFKn/Y&#43;KHTORelMMEn7mOp2AVPp&#43;7fr03dLgZiV3J" crossorigin="anonymous"
  ></script>


  





  
      
      <script src="/js/algolia_search.js" integrity="" crossorigin="anonymous" ></script>
      




  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/mouse-firework@0.1.0/dist/index.umd.js"
    
    
    
    
    integrity="sha384-KM6i7tu43nYd6e0beIljxHMC5tZc58XBDu7pPA58w50h18Jsx7gLdimfS09RXlKv" crossorigin="anonymous"
  ></script>


<script>
  if (window.firework) {
    const options = JSON.parse("{\"excludeelements\":[\"a\",\"button\"],\"particles\":[{\"colors\":[\"#ff5252\",\"#ff7c7c\",\"#ffafaf\",\"#ffd0d0\"],\"duration\":[1200,1800],\"easing\":\"easeOutExpo\",\"move\":[\"emit\"],\"number\":20,\"shape\":\"circle\",\"shapeOptions\":{\"alpha\":[0.3,0.5],\"radius\":[16,32]}},{\"colors\":[\"#ff0000\"],\"duration\":[1200,1800],\"easing\":\"easeOutExpo\",\"move\":[\"diffuse\"],\"number\":1,\"shape\":\"circle\",\"shapeOptions\":{\"alpha\":[0.2,0.5],\"lineWidth\":6,\"radius\":20}}]}");
    options.excludeElements = options.excludeelements;
    delete options.excludeelements;
    window.firework(options);
  }
</script>



  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/theme-shokax-pjax@0.0.3/dist/index.umd.js"
    
    
    
    
    integrity="sha384-xneY1WY8hOfUzswrE4CrYq35N4BdVcxqxwHPr9zawE/jMSCxD&#43;jAPU55x/jj3wlf" crossorigin="anonymous"
  ></script>


  <script>
    function loadScripts(scripts, index) {
      if (index < scripts.length) {
        const script = scripts[index];
        const src = script.getAttribute('src');

        const loadScript = (scriptContent) => {
          return new Promise((resolve, reject) => {
            const scriptElement = document.createElement('script');
            if (script.type) {
              scriptElement.type = script.type;
            }
            if (script.src) {
              scriptElement.src = script.src;
              scriptElement.onload = resolve;
              scriptElement.onerror = reject;
            }
            if (scriptContent) {
              scriptElement.text = scriptContent;
            }
            document.head.appendChild(scriptElement);
            if (!script.src) {
              resolve();
            }
          })
          
        }

        ;(src ? loadScript() : loadScript(script.text))
          .then(() => loadScripts(scripts, index + 1))
          .catch(error => {
            console.error(`Failed to load script: ${src || 'inline script'}`, error);
            loadScripts(scripts, index + 1);
          });
      }
    }
    window.Pjax &&
      new window.Pjax({
        selectors: [
          "#header>img",
          "#header>picture",
          "head title",
          "#header-title",
          "#subtitle-wrap",
          "#main",
          "#content",
          ".sidebar-widget",
          ".sidebar-wrapper",
          "#mobile-nav",
          "#lazy-script",
        ],
        switches: {
          "#content": function(oldEl, newEl) {
            
            oldEl.className = newEl.className;
            this.onSwitch();
          },
          "#header-title": Pjax.switches.outerHTML,
          "#subtitle-wrap": Pjax.switches.outerHTML,
          "#main": function (oldEl, newEl) {
            const scripts = [...newEl.querySelectorAll("script")];
            loadScripts(scripts, 0);
            oldEl.outerHTML = newEl.outerHTML;
            this.onSwitch();
          },
          "#mobile-nav": Pjax.switches.outerHTML,
          "#lazy-script": function (oldEl, newEl) {
            const scripts = [...newEl.querySelectorAll("script")];
            loadScripts(scripts, 0);
            oldEl.innerHTML = newEl.innerHTML;
            this.onSwitch();
          },
        },
        cacheBust: false,
      });
  </script>
  





  
      
      <script src="/js/pjax.js" integrity="" crossorigin="anonymous" ></script>
      







<div id="lazy-script">
  <div>
    
      
      
        
      
      <script data-pjax>
        window.REIMU_POST = {
          author: "Spid3r",
          title: "CSTV - CAPTURE THE FLAG 2023 | Digital Forensics",
          url: "https:\/\/blog.sondt.id.vn\/post\/ctsv_2023\/",
          description: "Trong bài viết này mình sẽ Writeups 3 bài Digital Forensics",
          cover: "https:\/\/blog.sondt.id.vn\/images\/ctsv_2023\/featured.png",
        };
      </script>
    
    
    
      





  
      
      <script src="/js/insert_highlight.js" integrity="" crossorigin="anonymous" data-pjax></script>
      

      
      
      
      
      <script type="module" data-pjax>
        const PhotoSwipeLightbox = (await safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe-lightbox.esm.min.js", "sha384-DiL6M\/gG\u002bwmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF\/N6lrZi\/")).default;

        const pswp = () => {
          if (_$$('.article-entry a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-entry',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")
            }).init();
          }
          if(_$$('.article-gallery a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-gallery',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")
            }).init();
          }
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script>
      












      
    
    
  </div>
</div>




  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js"
    
    async
    
    
    integrity="sha384-0M75wtSkhjIInv4coYlaJU83&#43;OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id&#43;S" crossorigin="anonymous"
  ></script>





  





  
       
         
      

  





  
      
      <script src="/js/service_worker.js" integrity="" crossorigin="anonymous" ></script>
      




  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/aplayer@1.10.1/dist/APlayer.min.js"
    
    
    
    
    integrity="sha384-gdGYZwHnfJM54evoZhpO0s6ZF5BQiybkiyW7VXr&#43;h5UfruuRL/aORyw&#43;5&#43;HZoU6e" crossorigin="anonymous"
  ></script>


  
    <script>
      const ap = new APlayer({
          theme: "var(--color-link)",
          container: document.getElementById('aplayer'),
          audio: JSON.parse("[{\"artist\":\"Miki Matsubara\",\"cover\":\"/images/song_covers/Mayonaka_no_Door_Stay_With_Me.jpg\",\"lrc\":\"/songs/Mayonaka_no_Door_Stay_With_Me.lrc\",\"name\":\"Stay With Me\",\"url\":\"/songs/Mayonaka_no_Door_Stay_With_Me.mp3\"},{\"artist\":\"Rokudenashi\",\"cover\":\"/images/song_covers/三時のキス.jpg\",\"lrc\":\"/songs/三時のキス.lrc\",\"name\":\"三時のキス\",\"url\":\"/songs/三時のキス.mp3\"},{\"artist\":\"Tomoko Aran\",\"cover\":\"/images/song_covers/Midnight Pretenders.jpg\",\"lrc\":\"/songs/Midnight Pretenders.lrc\",\"name\":\"Midnight Pretenders\",\"url\":\"/songs/Midnight Pretenders.mp3\"},{\"artist\":\"AKASAKI\",\"cover\":\"/images/song_covers/夏実.jpg\",\"lrc\":\"/songs/夏実.lrc\",\"name\":\"夏実\",\"url\":\"/songs/夏実.mp3\"},{\"artist\":\"Spectrum\",\"cover\":\"/images/song_covers/F・L・Y.jpg\",\"lrc\":\"/songs/F・L・Y.lrc\",\"name\":\"F・L・Y\",\"url\":\"/songs/F・L・Y.mp3\"},{\"artist\":\"『ユイカ』\",\"cover\":\"/images/song_covers/すないぱー。.jpg\",\"name\":\"すないぱー。\",\"url\":\"/songs/すないぱー。.mp3\"},{\"artist\":\"Yoko Oginome\",\"cover\":\"/images/song_covers/LAZY DANCE.jpg\",\"lrc\":\"/songs/LAZY DANCE.lrc\",\"name\":\"LAZY DANCE\",\"url\":\"/songs/LAZY DANCE.mp3\"}]") || [],
          fixed:  null  || false,
          autoplay:  false  || false,
          loop: 'all' || 'all',
          order: '' || 'list',
          preload: '' || 'auto',
          volume:  null  || 0.7,
          mutex:  null  || true,
          listFolded:  false  || false,
          lrcType:  3  || 0,
      });
    </script>
  





    
  </body>
</html>
